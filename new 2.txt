pip install pdf2image pytesseract pillow pandas openpyxl


import os
from pdf2image import convert_from_path
from PIL import Image
import pytesseract
import pandas as pd

# === CONFIGURATION ===
pdf_path = r"C:\path\to\your\file.pdf"
output_folder = r"C:\path\to\output_folder"
os.makedirs(output_folder, exist_ok=True)

# === STEP 1: Convert PDF → Images ===
print("Converting PDF to images...")
images = convert_from_path(pdf_path, dpi=300)
image_paths = []

for i, img in enumerate(images):
    image_path = os.path.join(output_folder, f"page_{i+1}.png")
    img.save(image_path, "PNG")
    image_paths.append(image_path)

print(f"Saved {len(image_paths)} image(s): {image_paths}")

# === STEP 2: Convert Images → Text (OCR) ===
all_text = []
print("Extracting text from images...")
for img_path in image_paths:
    text = pytesseract.image_to_string(Image.open(img_path))
    all_text.append({"image_file": os.path.basename(img_path), "extracted_text": text})

# === STEP 3: Save to CSV and Excel ===
csv_path = os.path.join(output_folder, "extracted_text.csv")
excel_path = os.path.join(output_folder, "extracted_text.xlsx")

df = pd.DataFrame(all_text)
df.to_csv(csv_path, index=False, encoding="utf-8-sig")
df.to_excel(excel_path, index=False)

print(f"Data saved to:\nCSV: {csv_path}\nExcel: {excel_path}")

# === STEP 4: Read Text Back from CSV/Excel ===
print("\nReading text back from Excel...")
df_read = pd.read_excel(excel_path)

# Example: print the first few extracted lines
for idx, row in df_read.head(3).iterrows():
    print(f"\n--- Page {idx+1} ---")
    print(row["extracted_text"][:300])  # Print first 300 chars
